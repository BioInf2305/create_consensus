# Consensus Sequence Generator from VCF and Reference FASTA

This Python script generates consensus sequences in **FASTA** format for each sample in a VCF file, using a provided reference FASTA sequence.  
It supports standard VCF files as well as VCF files generated by **PLINK**.

---

## Features

- Extracts reference sequences for a specified genomic region.
- Applies variant information from a VCF file to build consensus sequences.
- Supports **heterozygous genotypes** using IUPAC ambiguity codes.
- Handles missing data (`./.`) by substituting **N**.
- Raises clear errors for:
  - Reference allele mismatches.
  - Unexpected genotype formats.
- Outputs **FASTA sequences** for all samples in the VCF.

---

## Requirements

- Python **3.7+**
- Dependencies:
  - [`pysam`](https://pysam.readthedocs.io/en/latest/) : tested with 0.23.3
Install `pysam` via:
```bash
pip install pysam
```
## Usage
Run the script from command line:
```bash
python consensus_from_vcf.py \
    -v test_files/test1.vcf.gz \
    -f test_files/26_1_720bp.fasta \
    -c 6 \
    -s 1 \
    -e 720 \
    -o output.fa
```
### Arguments

| Option | Required | Default | Description |
|--------|----------|---------|-------------|
| `-v`, `--vcf` | ✅ | — | Input VCF file |
| `-f`, `--ref_fasta` | ✅ | — | Reference FASTA file |
| `-c`, `--chrom` | ✅ | — | Chromosome name (e.g., `chr1`) |
| `-s`, `--start` | ✅ | — | Start coordinate (1-based) |
| `-e`, `--end` | ✅ | — | End coordinate (1-based, inclusive) |
| `-S`, `--sample_list` | ❌ | None | a file with list of samples for which consensus sequences need to be created, by
default it create for all the samples in the vcf file |
| `-o`, `--output` | ❌ | `<chrom>_<start>_<end>.fa` | Output FASTA filename |
| `--plink_vcf` | ❌ | `False` | Use this flag if the VCF was generated by PLINK |

### Output
A FASTA file containing one sequence per sample in the VCF. 
Each sequence is wrapped at 60 characters per line.

### Acknowledgement
ChatGPT was used to improve the codes written in test.py. It was also used to write this README documentaiton. 
